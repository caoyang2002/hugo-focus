<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="description" content="Hugo Focus Theme Documentation">
  <meta name="viewport"
    content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <title>Hugo Focus</title>

  <!-- æµè§ˆå™¨å›¾æ ‡ -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

  <!-- é»˜è®¤ä¸»é¢˜ -->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify/lib/themes/vue.css">
</head>

<body>
  <div id="app">æ­£åœ¨åŠ è½½æ–‡æ¡£...</div>

  <script>
    // è·å–å½“å‰è¯­è¨€
    function getCurrentLanguage() {
      const hash = window.location.hash;
      if (hash.includes('/en/')) return 'en';
      if (hash.includes('/es/')) return 'es';
      return 'zh-cn';
    }

    window.$docsify = {
      // é¡¹ç›®ä¿¡æ¯
      name: 'Hugo Focus',
      repo: 'https://github.com/caoyang2002/hugo-focus',

      // è®¾ç½®é»˜è®¤é¦–é¡µ
      // homepage: 'zh-cn/README.md',
      homepage: '#',

      // ä¸ä½¿ç”¨ basePath
      basePath: '/',

      // åˆ«åé…ç½®
      alias: {},

      // åŠ è½½é…ç½®
      loadSidebar: true,
      loadNavbar: true,
      coverpage: true,

      // æœç´¢é…ç½®
      search: {
        maxAge: 86400000,
        paths: 'auto',
        placeholder: {
          '/zh-cn/': 'æœç´¢',
          '/en/': 'Search',
          '/es/': 'Buscar'
        },
        noData: {
          '/zh-cn/': 'æ‰¾ä¸åˆ°ç»“æœ',
          '/en/': 'No results found',
          '/es/': 'No se encontraron resultados'
        },
        depth: 3,
        namespace: 'hugo-focus-docs'
      },

      // å…¶ä»–é…ç½®
      maxLevel: 5,
      subMaxLevel: 4,
      mergeNavbar: true,
      auto2top: true,
      relativePath: false,

      // è‡ªå®šä¹‰æ’ä»¶
      plugins: [
        // åˆå§‹åŒ–å’Œé‡å®šå‘
        function (hook, vm) {
          hook.init(function () {
            const hash = window.location.hash;

            if (!hash || hash === '#/' || hash === '#') {
              const browserLang = (navigator.language || navigator.userLanguage).toLowerCase();
              const savedLang = localStorage.getItem('docsify-preferred-language');

              let targetLang = 'zh-cn';
              if (savedLang) {
                targetLang = savedLang;
              } else if (browserLang.startsWith('en')) {
                targetLang = 'en';
              } else if (browserLang.startsWith('es')) {
                targetLang = 'es';
              }

              window.location.replace('#/' + targetLang + '/');
            }
          });

          // æ·»åŠ è¯­è¨€åˆ‡æ¢å™¨
          hook.doneEach(function () {
            setTimeout(addLanguageSwitcher, 100);
          });
        },

        // è‡ªåŠ¨ä¿®æ­£ä¾§è¾¹æ é“¾æ¥ - æ ¸å¿ƒæ’ä»¶
        function (hook, vm) {
          hook.doneEach(function () {
            const currentLang = getCurrentLanguage();

            // ä¿®æ­£ä¾§è¾¹æ é“¾æ¥
            const sidebar = document.querySelector('.sidebar-nav');
            if (sidebar) {
              const links = sidebar.querySelectorAll('a[href]');

              links.forEach(link => {
                let href = link.getAttribute('href');

                // åªå¤„ç†ç›¸å¯¹è·¯å¾„çš„ markdown é“¾æ¥
                if (href && !href.startsWith('http') && !href.startsWith('#/')) {
                  // ç§»é™¤å¼€å¤´çš„ # æˆ– /
                  href = href.replace(/^#?\/?/, '');

                  // å¦‚æœä¸åŒ…å«è¯­è¨€å‰ç¼€ï¼Œæ·»åŠ å½“å‰è¯­è¨€å‰ç¼€
                  if (!href.startsWith(currentLang + '/') &&
                    !href.startsWith('zh-cn/') &&
                    !href.startsWith('en/') &&
                    !href.startsWith('es/')) {
                    href = currentLang + '/' + href;
                  }

                  // è®¾ç½®æ–°çš„ href
                  link.setAttribute('href', '#/' + href);
                }
              });
            }

            // ä¿®æ­£å¯¼èˆªæ é“¾æ¥
            const navbar = document.querySelector('.app-nav');
            if (navbar) {
              const links = navbar.querySelectorAll('a[href]');

              links.forEach(link => {
                let href = link.getAttribute('href');

                if (href && !href.startsWith('http') && !href.startsWith('#/')) {
                  href = href.replace(/^#?\/?/, '');

                  if (!href.startsWith(currentLang + '/') &&
                    !href.startsWith('zh-cn/') &&
                    !href.startsWith('en/') &&
                    !href.startsWith('es/')) {
                    href = currentLang + '/' + href;
                  }

                  link.setAttribute('href', '#/' + href);
                }
              });
            }
          });
        }
      ]
    }

    // è¯­è¨€åˆ‡æ¢å™¨
    function addLanguageSwitcher() {
      if (document.querySelector('.language-switcher')) {
        return;
      }

      const languages = [
        { code: 'zh-cn', name: 'ğŸ‡¨ğŸ‡³ ä¸­æ–‡', path: '#/zh-cn/' },
        { code: 'en', name: 'ğŸ‡ºğŸ‡¸ English', path: '#/en/' },
        { code: 'es', name: 'ğŸ‡ªğŸ‡¸ EspaÃ±ol', path: '#/es/' }
      ];

      const currentLang = getCurrentLanguage();

      const switcher = document.createElement('div');
      switcher.className = 'language-switcher';
      switcher.innerHTML = `
        <select class="lang-select">
          ${languages.map(lang => `
            <option value="${lang.path}" ${currentLang === lang.code ? 'selected' : ''}>
              ${lang.name}
            </option>
          `).join('')}
        </select>
      `;

      const select = switcher.querySelector('select');
      select.addEventListener('change', function () {
        const targetPath = this.value;
        const selectedLang = languages.find(l => l.path === targetPath);

        if (selectedLang) {
          localStorage.setItem('docsify-preferred-language', selectedLang.code);
          window.location.href = targetPath;
        }
      });

      const nav = document.querySelector('.app-nav');
      if (nav) {
        nav.appendChild(switcher);
      }
    }

    // æ‹¦æˆªæ–‡ä»¶è¯·æ±‚,è‡ªåŠ¨æ·»åŠ è¯­è¨€å‰ç¼€
    (function () {
      const originalOpen = XMLHttpRequest.prototype.open;

      XMLHttpRequest.prototype.open = function (method, url) {
        const currentLang = getCurrentLanguage();

        if (url && typeof url === 'string' && url.includes('.md')) {
          // å¤„ç†ç‰¹æ®Šæ–‡ä»¶
          if (url === '/_sidebar.md' || url === '/_navbar.md' ||
            url === '/_coverpage.md' || url === '/README.md') {
            url = '/' + currentLang + url;
          }
          // å¤„ç†æ™®é€šæ–‡ä»¶
          else if (!url.startsWith('http') &&
            !url.includes('/' + currentLang + '/') &&
            !url.startsWith('/' + currentLang + '/')) {

            // å¦‚æœæ˜¯ä»¥ / å¼€å¤´çš„ç»å¯¹è·¯å¾„
            if (url.startsWith('/')) {
              // æ£€æŸ¥æ˜¯å¦å·²ç»æœ‰å…¶ä»–è¯­è¨€å‰ç¼€
              const hasLangPrefix = url.startsWith('/zh-cn/') ||
                url.startsWith('/en/') ||
                url.startsWith('/es/');

              if (!hasLangPrefix) {
                url = '/' + currentLang + url;
              }
            }
          }

          // è¿‡æ»¤æœç´¢æ’ä»¶çš„æ— æ•ˆè¯·æ±‚
          if (url === '/guide.md' || url === '/config.md' ||
            (url.includes('/content/') && !url.includes('/' + currentLang + '/'))) {
            // é™é»˜å¤„ç†,è®©æœç´¢æ’ä»¶å¿½ç•¥
            url = '/_non_existent_for_search.md';
          }
        }

        return originalOpen.call(this, method, url);
      };
    })();
  </script>

  <!-- Docsify æ ¸å¿ƒ -->
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/docsify.min.js"></script>

  <!-- æ’ä»¶ -->
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/plugins/search.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/plugins/zoom-image.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/docsify-copy-code/dist/docsify-copy-code.min.js"></script>

  <!-- æ ·å¼ -->
  <style>
    .language-switcher {
      display: inline-block;
      margin-left: 20px;
    }

    .lang-select {
      padding: 6px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background: white;
      color: #333;
      font-size: 14px;
      cursor: pointer;
      outline: none;
      transition: all 0.3s ease;
    }

    .lang-select:hover {
      border-color: #42b983;
    }

    .lang-select:focus {
      border-color: #42b983;
      box-shadow: 0 0 0 2px rgba(66, 185, 131, 0.2);
    }

    @media (max-width: 768px) {
      .language-switcher {
        margin: 10px 0;
        width: 100%;
      }

      .lang-select {
        width: 100%;
      }
    }
  </style>
</body>

</html>