{{/* layouts/_default/_markup/render-link.html */}}
{{ $isExternal := strings.HasPrefix .Destination "http" }}

<a href="{{ .Destination | safeURL }}"
   {{ with .Title }}title="{{ . }}"{{ end }}
   {{ if $isExternal }}
   target="_blank"
   rel="noopener noreferrer"
   class="external-link"
   {{ else }}
   class="internal-link"
   {{ end }}>
  {{ .Text | safeHTML }}
  {{ if $isExternal }}
  <span class="external-icon">
    {{ $iconPath := "icon/action/link.svg" }}
    {{ $fullPath := printf "static/%s" $iconPath }}
    {{ if fileExists $fullPath }}
      {{ $svgContent := readFile $fullPath }}
      {{ $styledSvg := replace $svgContent "<svg" `<svg style="display:inline-block;width:0.85em;height:0.85em;vertical-align:middle;fill:currentColor"` }}
      {{ $styledSvg | safeHTML }}
    {{ else }}
      <span>↗</span>
    {{ end }}
  </span>
  {{ end }}
</a>

<style>
  /* 链接样式优化 */
  .external-link {
    color: #3b82f6;
    text-decoration: underline;
    text-decoration-color: rgba(59, 130, 246, 0.3);
    transition: text-decoration-color 0.2s, color 0.2s;
  }

  .external-link:hover {
    color: #2563eb;
    text-decoration-color: rgba(59, 130, 246, 0.8);
  }

  .internal-link {
    color: #8b5cf6;
    text-decoration: underline;
    text-decoration-color: rgba(139, 92, 246, 0.3);
    transition: text-decoration-color 0.2s, color 0.2s;
  }

  .internal-link:hover {
    color: #7c3aed;
    text-decoration-color: rgba(139, 92, 246, 0.8);
  }

  .external-icon {
    display: inline-flex;
    align-items: center;
    margin-left: 3px;
    opacity: 0.7;
    vertical-align: middle;
    transition: opacity 0.2s;
  }

  .external-link:hover .external-icon {
    opacity: 1;
  }

  .external-icon svg {
    width: 0.85em;
    height: 0.85em;
    fill: currentColor;
    display: inline-block;
  }

  /* 暗色模式适配 */
  @media (prefers-color-scheme: dark) {
    .external-link {
      color: #60a5fa;
      text-decoration-color: rgba(96, 165, 250, 0.4);
    }

    .external-link:hover {
      color: #93c5fd;
      text-decoration-color: rgba(147, 197, 253, 0.8);
    }

    .internal-link {
      color: #a78bfa;
      text-decoration-color: rgba(167, 139, 250, 0.4);
    }

    .internal-link:hover {
      color: #c4b5fd;
      text-decoration-color: rgba(196, 181, 253, 0.8);
    }
  }
</style>
